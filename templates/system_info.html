<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>System Information - PrintQue</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        .machine-id-box {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            border: 2px solid #dee2e6;
        }
        .machine-id {
            font-size: 24px;
            font-weight: bold;
            color: #0d6efd;
            background: #fff;
            padding: 15px;
            border: 2px solid #0d6efd;
            border-radius: 5px;
            font-family: 'Courier New', monospace;
            word-break: break-all;
        }
        .info-item {
            margin: 10px 0;
            padding: 10px;
            background: #f8f9fa;
            border-radius: 5px;
        }
        .copy-btn {
            margin-left: 10px;
        }
        .instructions {
            background: #e7f3ff;
            padding: 20px;
            border-radius: 10px;
            margin-top: 30px;
        }
    </style>
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
        <div class="container-fluid">
            <a class="navbar-brand" href="/">PrintQue</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="/">Dashboard</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/printers">Printers</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/license">License</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <div class="container mt-4">
        <h1>System Information</h1>
        
        <div class="machine-id-box">
            <h2>Your Machine ID</h2>
            <p class="text-muted">This unique identifier is required for hardware-locked licenses</p>
            <div class="d-flex align-items-center">
                <div class="machine-id" id="machineId">{{ info.machine_id }}</div>
                <button class="btn btn-primary copy-btn" onclick="copyMachineId()">
                    <i class="bi bi-clipboard"></i> Copy
                </button>
            </div>
        </div>

        <h3 class="mt-4">System Details</h3>
        <div class="row">
            <div class="col-md-6">
                <div class="info-item">
                    <strong>Hostname:</strong> {{ info.hostname }}
                </div>
                <div class="info-item">
                    <strong>Operating System:</strong> {{ info.system }} {{ info.release }}
                </div>
            </div>
            <div class="col-md-6">
                <div class="info-item">
                    <strong>Processor:</strong> {{ info.processor }}
                </div>
            </div>
        </div>

        <div class="instructions">
            <h3>How to Get a Hardware License</h3>
            <ol>
                <li>Copy your Machine ID above</li>
                <li>Email it to <a href="mailto:info@hartleyprinting.com?subject=PrintQue Hardware License Request&body=Machine ID: [PASTE YOUR MACHINE ID HERE]%0D%0A%0D%0APlease generate a hardware license for the following tier:%0D%0A[ ] STANDARD (10 printers)%0D%0A[ ] PREMIUM (20 printers)%0D%0A[ ] PROFESSIONAL (50 printers)%0D%0A[ ] ENTERPRISE (Unlimited)%0D%0A%0D%0ACompany Name:%0D%0AYour Name:">info@hartleyprinting.com</a></li>
                <li>Include which license tier you need</li>
                <li>You'll receive a permanent license key (starts with "HW-")</li>
                <li>Go to <a href="/license">Settings > License</a></li>
                <li>Enter your hardware license key</li>
                <li>Your license will be permanently activated for this machine!</li>
            </ol>
            <p class="mb-0"><strong>Note:</strong> Hardware licenses work offline and never expire, but they only work on this specific machine.</p>
        </div>

        <div class="mt-4">
            <a href="/" class="btn btn-secondary">Back to Dashboard</a>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
    function copyMachineId() {
        const machineId = document.getElementById('machineId').innerText;
        
        // Try modern clipboard API first
        if (navigator.clipboard && window.isSecureContext) {
            navigator.clipboard.writeText(machineId).then(() => {
                showCopyFeedback('Machine ID copied to clipboard!');
            }).catch(() => {
                fallbackCopy(machineId);
            });
        } else {
            // Fallback for older browsers
            fallbackCopy(machineId);
        }
    }
    
    function fallbackCopy(text) {
        const textArea = document.createElement("textarea");
        textArea.value = text;
        textArea.style.position = "fixed";
        textArea.style.left = "-999999px";
        document.body.appendChild(textArea);
        textArea.select();
        try {
            document.execCommand('copy');
            showCopyFeedback('Machine ID copied to clipboard!');
        } catch (error) {
            showCopyFeedback('Failed to copy. Please select and copy manually.', true);
        }
        document.body.removeChild(textArea);
    }
    
    function showCopyFeedback(message, isError = false) {
        const btn = document.querySelector('.copy-btn');
        const originalHtml = btn.innerHTML;
        btn.innerHTML = isError ? '❌ ' + message : '✅ ' + message;
        btn.classList.toggle('btn-danger', isError);
        btn.classList.toggle('btn-success', !isError);
        
        setTimeout(() => {
            btn.innerHTML = originalHtml;
            btn.classList.remove('btn-danger', 'btn-success');
            btn.classList.add('btn-primary');
        }, 2000);
    }
    </script>
</body>
</html>